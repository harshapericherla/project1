<?xml version="1.0" encoding="UTF-8"?>
<!--  
<flow xmlns="http://www.springframework.org/schema/webflow"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation=" http://www.springframework.org/schema/webflow
      http://www.springframework.org/schema/webflow/spring-webflow-2.4.xsd">
  
  <var name="order" class="com.niit.model.CustomerOrder"/>
  
  
  
  <action-state>
  <validate expression="cartDaoImpl.validate(requestParameters.cartId)" result="order.cart"></validate>
  <transition to="invalidCartWarning" on-exception="java.io.IOException"></transition>
  <transition to="collectCustomerDetails"></transition>
  </action-state>
 
  <view-state id="collectCustomerDetails" model="order">
     <transition on="collectedCustomerInfo" to="collectShippingDetails"></transition>
     <transition on="cancel" to="cancelCheckOut"/>
  </view-state>
  
  <view-state id="collectShippingDetails" model="order">
   _eventId_backToCollectCustomerDetails [back]
  <transition on="backToCollectCustomerDetails" to="collectCustomerDetails"></transition>
 
  _eventId_collectedShippingDetails [next]
  <transition on="collectedShippingDetails" to="purchaseSummary"></transition>
  
   _eventId_cancel [cancel]
  <tarnsition on="cancel" to="cancelCheckOut"></tarnsition>
  </view-state>
  
  <view-state id="purchaseSummary" model="order">
  <transition></transition>
   <transition></transition>
    <transition></transition>
  </view-state>
  
  
  
  <view-state id="invalidCartWarning">
  <transition to="endState"></transition>
  </view-state>
  
  <action-state id="cancelCheckOut">
  
  </action-state> 
 
  <end-state id="endState"></end-state> 
</flow>
--> 
 
<flow xmlns="http://www.springframework.org/schema/webflow"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow
      https://www.springframework.org/schema/webflow/spring-webflow-2.4.xsd">
      
       <var name="order" class="com.niit.model.CustomerOrder"/>
      
      
      <action-state id="invalid">
      
       <evaluate expression="cartDaoImpl.validate(requestParameters.cartId)" result="order.cart"></evaluate>
       <transition to="collectCustomerDetails"></transition>
       <transition on-exception="java.io.IOException" to="invalidCartWarning"/> 
      </action-state>
      
      <view-state id="invalidCartWarning">
      </view-state>   
   
     <view-state id="collectCustomerDetails" model="order">
     <transition on="collectedCustomerInfo" to="collectShippingDetails"></transition>
     <transition on="cancel" to="cancelCheckOut"/>
     </view-state>
      
      <view-state id="cardpage" view="views/card.jsp" model="cart">
      <transition on="cancel" to="paymentpage"></transition>
      <transition on="continue" to="cardpayment"></transition>
      </view-state>
      
       <action-state id="cardpayment">
      <evaluate expression="checkoutHandler.cardPayment(cart)" />
      <transition on="true" to="tqpage" />
      <transition on="false" to="paymentpage"/>
      </action-state>
      
        <view-state id="tqpage" view="views/tqpage.jsp"></view-state>
   
    
                  
      </flow>
 